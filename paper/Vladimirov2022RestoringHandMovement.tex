\documentclass[a4paper, 12pt]{article}

\input{preamble.tex}
\renewcommand{\abstractname}{Аннотация}

\title{Восстановление траектории движения руки по видео}

\author{Владимиров Эдуард \\
	\texttt{vladimirov.ea@phystech.edu} \\
	
	\And
	Курдюкова Антонина \\
	\texttt{kurdiukova.ad@phystech.edu} \\

	\And
	Исаченко Роман \\
	\texttt{roman.isachenko@phystech.edu} \\
	
	\And
	Стрижов Вадим \\
	\texttt{strijov@phystech.edu}
}
\date{\today}

\begin{document}
\maketitle

\begin{abstract}
	В работе решается задача прогнозирования временного ряда со сложной структурой. Под сложной структурой понимается наличие нелинейных зависимостей и варьирующийся период. Требуется найти причинно-следственные связи между временными рядами. Для этого предлагается снизить размерность траекторных пространств. В работе предложен новый способ согласованного снижения размерности многомерных временных рядов. Он объединяет метод частичных наименьших квадратов и метод перекрестных отображений Сугихары. Для демонстрации результатов работы решается задача восстановления траектории движения руки по видео.
\end{abstract}


\keywords{временной ряд \and фазовая траектория \and траекторное подпространство \and сходящееся перекрёстное отображение \and частичные наименьшие квадраты}

\section{Введение}

В данной работе решается задача прогнозирования временного ряда на основе других временных рядов. 
Одна из трудностей задачи заключается в обнаружении связи между временными рядами и исключении несвязанных временных рядов из прогностической модели. 
Решение этой проблемы повышает её качество.

В данной работе применяется метод сходящегося перекрёстного отображения (convergent cross mapping, CCM) или метод Сугихары \citep{Sugihara90, sugihara1990nonlinear}, который эффективен для временных рядов, порождённых динамической системой. 
Он основан на сравнении ближайших соседей в траекторном пространстве временного ряда $\bx$, полученных с помощью временного ряда $\by$.

При построении прогностической модели используется траекторная матрица (или матрица сдвига), описывающая фазовое пространство временного ряда. 
Например, в методе анализа спектральных компонент (singular spectrum analysis, SSA) \citep{golyandina2005ssa, golyandina2001analysis, zhigljavsky2010singular} прогноз временного ряда основан на спектральном разложении ковариационной матрицы, полученной по траекторной матрице. 
В CCM матрицы сдвига используются для проверки наличия липшицева отображения между траекторными пространствами.

Однако размерность траекторного пространства может оказаться чрезмерно высокой, что приводит к неустойчивости прогностической модели.
В таком случае необходимо снизить размерность траекторного пространства путём построения проекции фазовой траектории в некоторое подпространство. Для CCM нет конкретного способа выбрать подпространство, в котором аппроксимируется фазовая траектория.
В работе \citep{usmanova2020sphere_regr} эта проблема решается с помощью сферической регрессии. Согласно этому методу, информация об искомом подпространстве извлекается из множества эмпирических направлений $\{ \bx_i - \bx_j\, | \, i < j \}$, где $\bx_i \text{~--- элементы траекторного пространства в сферических координатах}$.
В работе \citep{alexandrov2005automatic} используется автоматический выбор пары главных компонент. Идея заключается в сравнении спектральных плотностей главных компонент. Также используется простой перебор по главным компонентам \citep{usmanova2019dependencies}.

Метод проекции в латентное пространство (partial least squares, PLS) \citep{rosipal2011nonlinear, rosipal2005overview} отбирает наиболее значимые признаки и строит новые как их линейные комбинации. 
Это позволяет получить простую, точную и устойчивую прогностическую модель.
Наряду с PLS используется метод канонического анализа корреляции (canonical correlation analysis, CCA) \citep{hardoon2004canonical}. 
Он похож на PLS за исключением того, что первый метод максимизирует ковариацию между проекциями, а последний ~--- корреляцию. 
Недостатком этих моделей является их низкая точность при оценивании нелинейных зависимостей между данными.
Разработаны нелинейные модели PLS \citep{qin1992nonlinear} и CCA \citep{andrew2013deep}.
В данной статье используется модель PLS-Autoencoder \citep{polson2021deep}, которая преобразует исходные данные с помощью автоэнкодеров. 

В теоретической части работы показано, как можно применить метод Сугихары для снижения размерности траекторного пространства и как объединить идеи методов PLS и CCM. 
Для осуществления последней цели введена новая метрика согласованности латентных проекций.

В качестве модели для предсказания временного ряда по набору временных рядов используется алгоритм локально взвешенного глобального линейного отображения (sequential locally weighted global linear map, SMap) \citep{sugihara1994nonlinear}.

Эксперимент проводится на наборе собранных вручную данных. Он представляет собой совокупность ключевых точек, полученных 
по видео движения человека, а также показания акселерометра и гироскопа, снятые с руки человека. 
В эксперименте строится прогноз временных рядов, использующий обнаруженные связанные компоненты временных рядов.

\section{Постановка задачи}
Пусть значения исходного многомерного временного ряда 
\[\bS_y(t) = [S_y^1(t), \ldots, S_y^r(t)]\T\]
доступны в моменты времени $t = 1, 2, \ldots, n$. Предполагается, что на значения $\bS_y(t)$ оказывает влияние набор вспомогательных временных рядов $S_x^1(t), \ldots, S_x^m(t)$.

Необходимо предсказать значения исходного временного ряда $\bS_y(t)$ в моменты времени $n+1, \ldots, n+p$. 
Предполагается, что значения вспомогательных временных рядов доступны в тот период времени, на который осуществляется предсказание временного ряда $\bS_y(t)$.

Для вычисления будущих значений временного ряда требуется определить функциональную зависимость, отражающую связь между прошлыми значениями $\bS_y(t)$ и будущими, а также принимающую во внимание влияние вспомогательных временных рядов $S_x^1(t), \ldots, S_x^m(t)$.

\begin{definition}
	\textbf{Моделью прогнозирования с учётом внешних факторов} называется функция:
	\begin{equation*}
		\bS_y(t) = \bF(\bw, \bS_y(t-1), \ldots, S_x^1(t), \ldots, S_x^m(t), \ldots) + \boldsymbol{\epsilon}_t.
	\end{equation*}
\end{definition}

Требуется создать такую модель, для которой среднее квадратичное отклонение истинного значения от прогнозируемого стремится к минимальному для заданного $p$. 

\begin{equation*}
	\widehat{E} = \dfrac{1}{p} \sum\limits_{i=n+1}^{n+p} ||\boldsymbol{\epsilon}_i||_2^2 \rightarrow \underset{\bw}{\text{min}}.
\end{equation*}

Особенность данной задачи заключается в том, что размер $m$ набора временных рядов довольно велик и что среди рядов $S_y^1(t), \ldots, S_y^m(t)$ есть много сильно скореллированных. 
Поэтому использование всего набора для прогнозирования временного ряда $S_x(t)$ приводит к низкому качеству прогноза. 

Один из способов решения этой проблемы заключается в выборе фиксированного числа временных рядов, оказывающих наибольшее влияние на целевую переменную, с помощью метода CCM. 
Для пары временных рядов
\begin{equation*}
(S_x^i(t), S_y^j(t)) \quad i = 1, \ldots, m \quad j = 1, \ldots r
\end{equation*} 
он определяет меру воздействия временного ряда $S_x^i(t)$ на целевую переменную $S_y^j(t)$. 
Далее выбираем временные ряды из набора с максимальной мерой воздействия.

\subsection{Метод CCM}
\begin{figure}[bhtp]
	\includegraphics[width=\textwidth]{block_scheme_4.pdf}
	\caption{Применение метода CCM для выбора наиболее значимых компонент временного ряда}
	\label{fig:schema}
\end{figure}

Определим траекторную матрицу временного ряда $\bx = [x_1, \ldots, x_n]$ следующим образом: 

\begin{equation*} \label{eq:traj_mat}
	\bH_{\bx} = \begin{bmatrix}
		x_1 & x_2 & \ldots & x_{\tau} \\
		x_2 & x_3 & \ldots & x_{\tau+1} \\
		\vdots & \vdots & \ddots & \vdots \\
		x_{N} & x_{N+1} & \ldots & x_n
	\end{bmatrix}, 
\end{equation*} 

где $N$ --- число задержек, $\tau = n - N + 1$.

Обозначим $i\text{-ый}$ столбец матрицы $\bH_{\bx}$ за $\bx_i$. 
Матрица $\bH_{\bx}$ принимает вид:

\begin{equation*} \label{eq:traj_mat_short}
	\bH_{\bx} = [\bx_1, \ldots, \bx_{\tau}], \qquad \bx_i = [x_i, x_{i+1}, \ldots, x_{i+N-1}]\T 
\end{equation*}

Заметим, что все векторы $\bx_t$ принадлежат $N\text{-мерному}$ траекторному пространству $\dH_{\bx} \subseteq \dR^N$ ряда $\bx$ и образуют фазовую траекторию $\bx(t) \in \dR^N$.

Для обнаружения зависимости между временными рядами $\bx$ и $\by$ возьмём элемент $\bx_0$ из траекторного пространства $\dH_{\bx}$ и найдём $k$ ближайших соседей в этом же пространстве. Обозначим их временные индексы (от ближнего к дальнему) $t_1, \ldots, t_k$.

Так как оба временных ряда определены на одной временной оси, то по значению временного ряда $\bx$ в момент времени $t_0 \in \{ 1, \ldots, n\}$ можно однозначно получить значение временного ряда $\by$ в тот же момент времени, и наоборот. Введём отображение из $\dH_{\bx}$ в $\dH_{\by}$ следующим образом: 
$$ \phi: \bx_0 \mapsto \widehat{\by_0} = \sum\limits_{i=1}^k w_i \by_{t_i}, \qquad 
w_i = \dfrac{u_i}{\sum\limits_{j=1}^k u_j}, \qquad
u_i = \exp(-||\bx_0 - \bx_{t_i}||).$$

\begin{definition}
	Временные ряды $\bx$ и $\by$ называются \textbf{связанными}, если отображение $\phi$ является липшицевым:
	$$ \rho_{\dH_{\by}}(\phi(\bx_i), \phi(\bx_j)) \leq C \rho_{\dH_{\bx}}(\bx_i, \bx_j) \qquad \bx_i, \bx_j \in \dH_{\bx}. $$
\end{definition}

Для проверки наличия связанности введём метрическую функцию близости векторов в окрестностях $U_k(\bx_{t_0})$ и $U_k(\by_{t_0})$:

\begin{equation}
	L(\bx, \by) = \dfrac{R(U_k(\bx_{t_0}))}{R(U_k(\by_{t_0}))}, \qquad R(U_k(\bx_{t_0})) = \dfrac{1}{k} \sum\limits_{i=1}^k \rho_{\dH_{\bx}}(\bx_{t_0}, \bx_{t_j}).
\end{equation}

Если $L(x, y)$ больше заданного порога $C(n)$, то временной ряд $\by$ зависит от временного ряда $\bx$.

\subsection{Метод PLS}
Другой способ решения поставленной ранее проблемы заключается в согласованном снижении размерности
Метод частичных наименьших квадратов восстанавливает связь между наборами данных $\bX$ и $\bY$. 
Матрицы объектов $\bX$ и целевая матрица $\bY$ проецируются на латентное пространство $\dR^l$ меньшей размерности следующим образом:
$$ \underset{n \times d}{\bX} = \underset{n \times K}{\bT} \cdot \underset{K \times d}{\bP\T} + \underset{n \times d}{\bE} $$
$$ \underset{n \times s}{\bY} = \underset{n \times K}{\bU} \cdot \underset{K \times s}{\bQ\T} + \underset{n \times s}{\bF}, $$
где $\bT$ и $\bU$ --- матрицы описания объектов и исходов в латентном пространстве, $\bP$ и $\bQ$ --- матрицы перехода из латентного пространства в исходное, $\bE$ и $\bF$ --- матрицы остатков.

Псевдокод метода регрессии PLS приведен в алгоритме \ref{alg:pls}. Алгоритм итеративно на каждом из $K$ шагов вычисляет по одному столбцу $\bt_k, \bu_k, \bp_k, \bq_k$ матриц $\bT, \bU, \bP, \bQ$ соответственно. После вычисления следующего набора векторов из матриц $\bX, \bY$ вычитаются очередные одноранговые аппроксимации.

Функция преобразования исходных данных имеет вид: 
$$ f(\bX) = \bX\bW_{\bx} \qquad g(\bY) = \bY\bW_{\by}, $$ 
где матрицы весов $\bW_{\bx} \in \dR^{d \times K}$ и $\bW_{\by} \in \dR^{s \times K}$ находятся путём максимизации выборочной ковариации:
$$ (\bW_{\bx}, \bW_{\by}) = \underset{\bW_{\bx}, \bW_{\by}}{\text{argmax}}\; \text{Cov}(\bX\bW_{\bx}, \bY\bW_{\by})$$

Из алгоритма PLS можно получить явный вид матриц $\bW_{\bx}$ и $\bW_{\by}$. Заметим, что:
$$ \bX \cdot \bA(\bP \T \bA)^{-1} = (\bT \bP \T \bA + \bE \bA)(\bP \T \bA)^{-1} \approx \bT, $$
где матрица $\bA$ образована из столбцов $\ba_k$. Аналогично, $\bY \cdot \bB(\bQ \T \bB)^{-1} \approx \bU$, где матрица $\bB$ образована из столбцов $\bb_k$. 
Таким образом:
$$ \bW_{\bx} = \bA(\bP \T \bA)^{-1}, \qquad \bW_{\by} = \bB(\bQ \T \bB)^{-1}. $$

\begin{algorithm}[bhtp]
	\caption{Canonical PLS}\label{alg:pls}
	\begin{algorithmic}
		\Require $\bX \in \dR^{n \times d}, \: \bY \in \dR^{n \times s}, \: K \in \mathds{N}$
		\Ensure $\bT, \: \bU, \: \bP, \: \bQ$
		
		\State Нормировать матрицы $\bX$ и $\bY$ по столбцам
		\State $\bX_1 \gets \bX$
		\State $\bY_1 \gets \bY$

		\For{$k = 1, \ldots, K$}
			\If{$\bX_k^T \bY_k = 0$}
				\State \textbf{break}
			\EndIf
			\State Вычислить $\ba_k \in \dR^d$ и $\bb_k \in \dR^s$, первые
			\State левые и правые сингулярные вектора матрицы $\bX_k^T \bY_k$.
			\State Из определения следует, что $(\ba_k, \bb_k) = \underset{\ba, \bb}{\text{argmax}} \text{ Cov} (\bX_k \ba, \bY_k \bb)$.
			
			\State $\bt_k \gets \bX_k \ba_k$
			\State $\bu_k \gets \bY_k \bb_k$
			
			\State $\bp_k^T = (\bt_k^T \bt)^{-1} \bt_k^T \bX_k$
			\Comment{Вектора $\bp_k$ образуют матрицу $\bP$}
			\State $\bq_k^T = (\bu_k^T \bu_k)^{-1} \bu_k^T \bY_k$
			\Comment{Вектора $\bq_k$ образуют матрицу $\bQ$}
			
			\State $\widehat{\bX_k}(\bt_k) = \bt_k \bp_k^T$
			\Comment{Регрессируем $\bX_k$ по $\bt_k$}
			\State $\widehat{\bY_k}(\bu_k) = \bu_k \bq_k^T$
			\Comment{Регрессируем $\bY_k$ по $\bu_k$}
			
			\State $\bX_{k+1} \gets \bX_k - \widehat{\bX_k}(\bt_k)$
			\State $\bY_{k+1} \gets \bY_k - \widehat{\bY_k}(\bu_k)$
		\EndFor
	\end{algorithmic}
\end{algorithm}

\subsection{Методы PLS-Autoencoder и PLS-CCM}
Основной минус классического метода PLS заключается в низком качестве при работе с данными, которые имеют сложные нелинейные зависимости. 
По этой причине были разработаны расширения линейного метода PLS, которые преобразуют входные данные с помощью гладких нелинейных функций.
 
Одним из таких расширений является метод PLS-Autoencoder. 
В качестве параметрической функций, которые переводят исходные данные в латентное пространство и обратно, выступают нейронные сети.
В данной работе используются многослойные перцептроны.

\begin{figure}[bhtp]
	\centering
	\begin{tikzpicture}[scale=1.5, every node/.style={scale=1.5}]
		\matrix (m) [matrix of math nodes,row sep=6em,column sep=8em,minimum width=4em]
		{
			\underset{n \times d}{\bX} & \underset{n \times s}{\bY} \\
			\underset{n \times K}{\mathbf{T}} & \underset{n \times K}{\mathbf{U}} \\
		};
		\path[-stealth]
		(m-2-1) edge node [right] {$\phi_{\text{dec}}$} (m-1-1)
		(m-2-2) edge node [left] {$\psi_{\text{dec}}$} (m-1-2)
		(m-1-1) edge [bend right] node [left] {$\phi_{\text{enc}}$} (m-2-1)
		(m-1-2) edge [bend left] node [right] {$\psi_{\text{enc}}$} (m-2-2)
		(m-2-1) edge [<->] node [above] {$\mathcal{L}_{\text{cons}}$} (m-2-2);
	\end{tikzpicture}
	\caption{PLS-Autoencoder}
	\label{fig:pls-ae}
\end{figure}

Функция потерь данной модели имеет вид:
\begin{gather*}
	\mathcal{L} = \lambda_1 \cdot \mathcal{L}^X_{\text{recov}}(\bX, \hat{\bX}) + \lambda_2 \cdot \mathcal{L}^Y_{\text{recov}}(\bY, \hat{\bY}) + \lambda_3 \cdot \mathcal{L}_{\text{cons}}(\bT, \bU), 
	\qquad \lambda_1, \lambda_2, \lambda_3 > 0	\\
	\mathcal{L}^X_{\text{recov}}(\bX, \hat{\bX}) = || \bX - \hat{\bX}||_2^2 \: , \text{ где } \hat{\bX} = \phi_{\text{dec}}(\phi_{\text{enc}}(\bX)) \\
	\mathcal{L}^Y_{\text{recov}}(\bY, \hat{\bY}) = || \bY - \hat{\bY}||_2^2 \: , \text{ где } \hat{\bY} = \psi_{\text{dec}}(\psi_{\text{enc}}(\bY)) \\
	\mathcal{L}_{\text{cons}}(\bT, \bU) = \dfrac{1}{1 + \left( \frac{1}{n} \, tr(\bU_{\text{centered}}\T \bT_{\text{centered}}) \right)^2}
\end{gather*}
где $\mathcal{L}_{\text{recov}}$ отвечает за то, насколько точно восстанавливаются исходные данные по их проекциям в латентное пространство, а $\mathcal{L}_{\text{cons}}$ отвечает за связанность низкоразмерных латентных представлений.

Стоит подчеркнуть, что $\mathcal{L}_{\text{cons}}$ максимизирует квадрат суммы ковариаций соответствующих признаков, которые являются столбцами матриц $\bT$ и $\bU$. 
Таким образом, этот метод не учитывает согласованность объектов в латентном пространстве, то есть строк матриц $\bT$ и $\bU$.

Новый метод PLS-CCM учитывает объектную согласованность с помощью метрических функций из метода CCM. Он является расширением PLS-Autoencoder, только добавляется новая функция потерь:
$$ \mathcal{L}_\text{oc}(\bX, \bY, \bU, \bT) = \left( CCM_{XY} - CCM_{UT} \right)^2 ,$$
где $CCM_{XY}$ ~--- величина, характеризующая качество аппроксимации $\by_n$ с помощью $\bx_n$, построенной в траекторном пространстве, состоящем из первых $n-1$ объектов, а $CCM_{UT}$ ~--- та же величина, полученная из матриц $\bU$ и $\bT$.

\begin{figure}[bhtp]
	\centering
	\begin{tikzpicture}[scale=1.5, every node/.style={scale=1.5}]
		\matrix (m) [matrix of math nodes,row sep=6em,column sep=8em,minimum width=4em]
		{
			\underset{n \times d}{\bX} & \underset{n \times s}{\bY} \\
			\underset{n \times K}{\mathbf{T}} & \underset{n \times K}{\mathbf{U}} \\
		};
		\path[-stealth]
		(m-2-1) edge node [right] {$\phi_{\text{dec}}$} (m-1-1)
		(m-2-2) edge node [left] {$\psi_{\text{dec}}$} (m-1-2)
		(m-1-1) edge [bend right] node [left] {$\phi_{\text{enc}}$} (m-2-1)
		(m-1-2) edge [bend left] node [right] {$\psi_{\text{enc}}$} (m-2-2)
		(m-2-1) edge [<->] node [above] {$\mathcal{L}_{\text{fc}} + CCM_{TU}$} (m-2-2)
		(m-1-1) edge [<->] node [above] {$CCM_{XY}$} (m-1-2);
	\end{tikzpicture}
	\caption{PLS-CCM}
	\label{fig:pls-ccm}
\end{figure}

%Feature consistency: $\mathcal{L}_{fc}(T, U) = \exp(-\frac{1}{n} tr(U_{centered}\T T_{centered}))$

%Object consistency: $\mathcal{L}_{oc}(X, Y, T, U) = (CCM_{XY} - CCM_{TU})^2$

%Recovering: $\mathcal{L}_{recov}(X, \hat{X}) = || X - \hat{X} ||_2^2$

% Объяснение симплекс метода: \href{http://opetchey.github.io/RREEBES/Sugihara_and_May_1990_Nature/Simplex_projection_walkthrough.html#:~:text=From%20the%20supplementary%20information%20of,lagged%20coordinate%20state%20space%20reconstruction)}{тык}

\section{Вычислительный эксперимент}
Целью эксперимента является сравнение различных стратегий снижения размерности целевого пространства. Важной его частью является изучение результатов модели прогнозирования временного ряда, применённого к элементам пространства фазовых траекторий и траекторного подпространства меньшей размерности.

\begin{figure}[bhtp]
	\includegraphics[width=\textwidth]{cyclic_devices_data.png}
	\caption{Данные акселерометра и гироскопа}
	\label{fig:devices_data}
\end{figure}
Первоначальные данные представляют собой набор видеороликов, на которых выполняются различные движения руками (циклические и хаотические), а также показания акселерометра и гироскопа частотой в 100 Герц, закреплённых на одной из рук. 
Далее по видеоряду с помощью фреймворка alphapose \citep{alphapose_fang2017rmpe, alphapose_li2018crowdpose, alphapose_xiu2018poseflow} получаются координаты конечностей, а именно 68 ключевых точек. 
Затем из полученного временного ряда исключаются сильно скореллированные компоненты.
После этого полученные многомерные временные ряды приводятся к одной временной шкале с помощью удаления элементов более длинного временного ряда.

Перед началом эксперимента зафиксируем следующие переменные: $N$ ~--- размерность траекторного пространства, $k$ ~--- число ближайших соседей, рассматриваемых в CCM, $n_{tr}$ ~--- размер обучающей выборки, $E_{vid}$ ~--- число признаков, полученных из видео-ряда, которые будут использованы в алгоритме.
Для каждой пары компонент, взятых из разных временных рядов, применим метод CCM.
В результате получим матрицу корреляций, в которой на $i\text{-ой}$ строке и $j\text{-ом}$ столбце стоит коэффициент корреляции Пирсона между $i\text{-ой}$ компонентной "приборного" временного ряда и $j\text{-ой}$ компонентой ряда, восстановленного по видео. 
После этого для каждого целевого признака выбираем $E_{vid}$ видео-признаков, обладающих максимальной корреляцией в соответствующей строке.
Затем на основе этих признаков обучается алгоритм.

\begin{figure}[bhtp]
	\centering
	\subfloat[Результат работы фреймворка alphapose]{%
		\includegraphics[width=0.45\linewidth]{after_alphapose.png}%
	}
	\subfloat[Данные кейпоинтов, полученные по видео]{%
		\includegraphics[width=0.45\linewidth]{cyclic_video_data.png}
	}
	\label{fig:video_data}
\end{figure}

\section{Анализ ошибки}
\begin{table}[bhtp]
	\fontsize{10pt}{14pt}
	\selectfont
	\centering
	\caption{Сравнение ошибки (MSE) предсказательной модели, применённой в траекторном пространстве и в его подпространстве, полученном CCM}
	\label{tbl:space_and_subspace}
	\begin{tabularx}{\textwidth}{c|XXXXXX}
		\hline
		& acc\_z & acc\_y & acc\_x & gyr\_z & gyr\_y & gyr\_x \\
		\hline
		space & 1.053 $\pm$ 2.223 & 0.401 $\pm$ 0.833 & 0.483 $\pm$ 0.825 & 0.084 $\pm$ 0.537 & 0.090 $\pm$ 0.094 & 0.063 $\pm$ 0.295 \\
		subspace & 0.315 $\pm$ 0.461 & 0.043 $\pm$ 0.051 & 0.150 $\pm$ 0.177 & 0.001 $\pm$ 0.001	& 0.015 $\pm$ 0.031 & 0.001 $\pm$ 0.003 \\
		\hline
	\end{tabularx}
\end{table}

Для начала сравним качество предсказаний прогностической модели, применённой в траекторном пространстве и его подпространстве.
В таблице \ref{tbl:space_and_subspace} представлены среднеквадратичная ошибки предсказаний значений акселерометра и гироскопа по каждой из осей и их стандартные отклонения. 
На ней видно, что прогностическая модель, применённая в траекторном подпространстве, даёт более точные предсказания, поскольку большинство признаков исходного признакового пространства неинформативно.

Далее, рассмотрим различные методы снижения размерности траекторного пространства. В таблице \ref{tbl:methods} видно, что добавление данных из видеоряда повышает качество модели предсказания.

\begin{table}[bhtp]
	\centering
	\caption{Среднеквадратичное отклонение между истинными показаниями устройств и предсказаниями, полученными с помощью одного из методов снижения размерности}
	\label{tbl:methods}
	\begin{tabular}{l|c|lll}
		\hline
		\multicolumn{2}{l}{\diaghead{\hskip4cm}{Целевой признак}{Метод}} \vline & CCM & PLS & CCA \\
		\hline
		\multirow{6}{*}{\rotatebox[origin=c]{90}{cyclic}} & acc\_z & 0.163 & \textbf{0.040} & 0.116 \\
		& acc\_y & 0.009 & \textbf{0.007} & 0.011 \\
		& acc\_x & \textbf{0.044} & 0.045 & 0.089 \\
		& gyr\_z & \textbf{0.000} & 0.001 & 0.001 \\
		& gyr\_y & \textbf{0.002} & 0.004 & 0.005 \\
		& gyr\_x & 0.009 & \textbf{0.004} & \textbf{0.004} \\
		\hline
		\multirow{6}{*}{\rotatebox[origin=c]{90}{chaotic}} & acc\_z & \textbf{0.315} & 0.416 & 0.416 \\
		& acc\_y & \textbf{0.043} & 0.045 & 0.429 \\
		& acc\_x & \textbf{0.150} & 0.177 & 0.221 \\
		& gyr\_z & \textbf{0.001} & 0.002 & 0.003 \\
		& gyr\_y & \textbf{0.015} & 0.022 & 0.061 \\
		& gyr\_x & \textbf{0.001} & 0.013 & 0.015 \\
		\hline   
	\end{tabular}
\end{table}

\section{Заключение}
В работе предложен метод обобщения методов PLS и CCA с помощью метода Сугихары путём построения эмбеддингов и выбора метрики для оценки качества аппроксимации.  
Проведён вычислительный эксперимент на данных устройств и видеоряда. 
Получено, что использование данных из видео повышает качество прогнозирования. 
Показано, что прогностическая модель менее устойчива в случае, когда та применяется в траекторном пространстве.

В дальнейшем планируется применить метод не к двумерным данным, которые соответствуют регулярным измерениям некоторой величины, а уже к спорадическим временным рядам. 
Это означает, что входными данными будут служить тензоры (???).

\bibliographystyle{unsrtnat}
\bibliography{Vladimirov2022RestoringHandMovement.bib}

\end{document}