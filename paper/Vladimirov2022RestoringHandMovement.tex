\documentclass[a4paper, 12pt]{article}

\input{preamble.tex}
\renewcommand{\abstractname}{Аннотация}

\title{Восстановление траектории движения руки по видео}

\author{Владимиров Эдуард \\
	\texttt{vladimirov.ea@phystech.edu} \\

	\And
	Исаченко Роман \\
	\texttt{isa-ro@yandex.ru} \\
	
	\And
	Курдюкова Антонина \\
	\texttt{kurdiukova.ad@phystech.edu} \\
}
\date{\today}

\begin{document}
\maketitle

\begin{abstract}
	Решается задача прогнозирования временного ряда со сложной структурой. Под сложной структурой понимается наличие зависимостей и варьирующийся период. Требуется найти причинно-следственные связи между рядами и снизить размерность траекторных пространств. В работе показано, что методы канонического корреляционного анализа, такие как метод главных компонент, метод частичных наименьших квадратов и другие, являются частным случаем метода перекрестных отображений Сугихары. Для демонстрации результатов работы используется траектория движения руки, восстановленная по видео, и сигнал акселерометра.
\end{abstract}


\keywords{временной ряд \and фазовая траектория \and траекторное подпространство \and сходящееся перекрёстное отображение \and частичные наименьшие квадраты \and канонический корреляционный анализ}

\section{Введение}
В данной работе решается задача прогнозирования временного ряда на основе других рядов. 
Одна из трудностей задачи заключается в обнаружении связи между рядами и исключении несвязанных рядов из прогностической модели. 
Решение этой проблемы повышает качество прогноза.

В данной работе применяется метод сходящегося перекрёстного отображения (convergent cross mapping, CCM) \citep{Sugihara90, sugihara1990nonlinear}, который эффективен для рядов, порождённых динамической системой. 
Он основан на сравнении ближайших соседей в траекторном пространстве ряда $\bx$, полученных с помощью ряда $\by$.

При построении прогностической модели используется траекторная матрица (или матрица сдвига), описывающая фазовое пространство временного ряда. 
Например, в методе анализа спектральных компонент (singular spectrum analysis, SSA) \citep{golyandina2005ssa, golyandina2001analysis, zhigljavsky2010singular} прогноз временного ряда основан на спектральном разложении ковариационной матрицы, полученной по траекторной. 
В CCM матрицы сдвига используются для проверки наличия липшицева отображения между траекторными пространствами.

Однако размерность траекторного пространства может оказаться чрезмерно высокой, что приводит к неустойчивости прогностической модели.
В таком случае необходимо снизить размерность траекторного пространства путём построения проекции фазовой траектории в некоторое подпространство. Для CCM нет конкретного способа выбрать подпространство, в котором аппроксимируется фазовая траектория.
В работе \citep{usmanova2020sphere_regr} эта проблема решается с помощью сферической регрессии. Согласно этому методу, информация об искомом подпространстве извлекается из множества эмпирических направлений $\{ \bx_i - \bx_j\, | \, i < j \}$.
В работе \citep{alexandrov2005automatic} используется автоматический выбор пары главных компонент. Идея заключается в сравнении спектральных плотностей главных компонент. Также используется простой перебор по главным компонентам \citep{usmanova2019dependencies}.

Метод проекции в латентное пространство (partial least squares, PLS) \citep{rosipal2011nonlinear, rosipal2005overview} отбирает наиболее значимые признаки и строит новые как их линейные комбинации. 
Это позволяет получить простую, точную и устойчивую прогностическую модель.
Наряду с PLS используется метод канонического анализа корреляции (CCA) \citep{hardoon2004canonical}. 
Он похож на PLS за исключением того, что первый метод максимизирует ковариацию, а последний ~--- корреляцию. 
Недостатком этих моделей является их низкая точность при оценивании нелинейных зависимостей между данными.
Разработаны нелинейные модели PLS\citep{qin1992nonlinear, hiden1998non} и CCA\citep{lai2000kernel, andrew2013deep}.
В данной статье используется модель NNPLS \citep{bulut2014new}, которая преобразует исходные данные с помощью нейронной сети. 

В теоретической части работы показано, что CCA и PLS являются частными случаями CCM.

В качестве модели для предсказания временного ряда по набору рядов используется алгоритм многомерной гусеницы \citep{golyandina2005ssa}, являющийся
обобщением на многомерный случай алгоритма SSA

Эксперимент проводится на наборе вручную собранных данных. Он представляет собой совокупность ключевых точек, полученных 
по видео движения человека, а также показания акселерометра и гироскопа, снятые с руки человека. 
В эксперименте строится прогноз рядов, использующий обнаруженные связанные компоненты рядов

\section{Постановка задачи}
Пусть значения исходного временного ряда $\bx(t)$ доступны в  моменты времени $t = 1, 2, \ldots, n$. Предполагается, что на значения $\bx(t)$ оказывает влияние набор внешних факторов $\by_1(t), \ldots, \by_m(t)$

В момент прогноза $n$ необходимо определить будущие значения исходного процесса $\bx(t)$ в моменты времени $n+1, \ldots, n+p$, учитывая влияние внешних факторов $\by_1(t), \ldots, \by_m(t)$. При этом считаем, что значения внешних факторов в моменты времени $\by_1(n+1), \ldots, \by_1(n+p), \ldots, \by_m(n+1), \ldots, \by_m(n+p)$ являются доступными.

Для вычисления будущих значений временного ряда требуется определить функциональную зависимость, отражающую связь между прошлыми значениями $\bx$ и будущими, а также принимающую во внимание влияние внешних факторов $\by_1, \ldots, \by_m$.

\begin{equation} \label{eq:general_model}
	\bx(t) = F(\bx(t-1), \ldots, \by_1(t), \, \by_1(t-1), \ldots, \by_m(t), \, \by_m(t-1), ...) + \epsilon_t
\end{equation}

Зависимость \eqref{eq:general_model} называется \textbf{моделью прогнозирования с учётом внешних факторов}.
Требуется создать такую модель, для которой среднее квадратичное отклонение истинного значения от прогнозируемого стремится к минимальному для заданного $p$. 

\begin{equation} \label{eq:model_error}
	\hat{E} = \dfrac{1}{p} \sum\limits_{i=n+1}^{n+p} \epsilon_i^2 \rightarrow min
\end{equation}

\subsection{Метод CCM}
Зададим для временного ряда $\bx = [x_1, \ldots, x_n]$ его траекторную матрицу следующим образом: 

\begin{equation*} \label{eq:traj_mat}
	\bH_{\bx} = \begin{bmatrix}
		x_1 & x_2 & \ldots & x_{\tau} \\
		x_2 & x_3 & \ldots & x_{\tau+1} \\
		\vdots & \vdots & \ddots & \vdots \\
		x_{N} & x_{N+1} & \ldots & x_n
	\end{bmatrix}, 
\end{equation*} 

где $N$ --- число задержек, $\tau = n - N + 1$

Обозначим i-ый столбец матрицы $\bH_{\bx}$ как $\bx_i$. 
Тогда матрица $\bH_{\bx}$ примет вид:

\begin{equation*} \label{eq:traj_mat_short}
	\bH_{\bx} = [\bx_1, \ldots, \bx_{\tau}], \qquad \bx_i = [x_i, x_{i+1}, \ldots, x_{i+N-1}]\T 
\end{equation*}

Заметим, что все векторы $\bx_t$ принадлежат N-мерному траекторному пространству $\dH_{\bx} \subseteq \dR^N$ ряда $\bx$ и образуют фазовую траекторию $\bx(t) \in \dR^N$.

Обнаружение зависимости между рядами $\bx$ и $\bz$ осуществляется следующим образом. Выберем момент $t_0 \in \{ 1, \ldots, \tau\}$ и найдём $k$ ближайших соседей $\bx_{t_0}$ в $\dH_{\bx}$. Обозначим их множество как $U_k(\bx_{t_0}) = \{ \bx_{t_1}, \ldots, \bx_{t_k} \}$. 

Так как оба ряда определены на одной временной оси, найдём $U_k(\bz_{t_0})$ в пространстве $\dH_{\bz}$, проделав все вышеприведённые операции. Определим отображение из $U_k(\bx_{t_0})$ в $U_k(\bz_{t_0})$ следующим образом: 
$$ \phi: \bx_{t_i} \rightarrow \bz_{t_i}, \qquad i = 1, \ldots, k$$.
Утверждается, что ряды $\bx$ и $\bz$ связаны, если отображение $\phi$ является липшицевым.
$$ \rho_{\dH_{\bz}}(\phi(\bx_i), \phi(\bx_j)) \leq n \rho_{\dH_{\bx}}(\bx_i, \bx_j) \qquad \forall \bx_i, \bx_j \in \dH_{\bx}$$

Проверим наличие такого отображения следующим образом. Введём меру близости векторов в окрестностях $U_k(\bx_{t_0})$ и $U_k(\bz_{t_0})$:

\begin{equation}
	L(\bx, \bz) = \dfrac{R(U_k(\bx_{t_0}))}{R(U_k(\bz_{t_0}))}, \qquad R(U_k(\bx_{t_0})) = \dfrac{1}{k} \sum\limits_{i=1}^k \rho_{\dH_{\bx}}(\bx_{t_0}, \bx_{t_j})
\end{equation}

Если $L(x, z)$ больше некоторого порога $C(n)$, то ряд $\bz$ зависит от ряда $\bx$

Прогноз $\hat{x_t}$ первого элемента вектора $\bx$ строится следующим образом:

$$\hat{x_t} = \sum\limits_{i=1}^k w_i x_{t_i}, \qquad
w_i = \dfrac{u_i}{\sum\limits_{j=1}^k u_j}, \qquad
u_i = \exp(-||\bx_t - \bx_{t_i}||), $$
где $x_{t_i}$ --- первые компоненты ближайших соседей $\bx_t$

% Предполагается, что размерность траекторного пространства избыточна, что приводит к неустойчивости прогностической моделей ряда $\bx$.
% Поэтому предлагается рассматривать не саму траекторию $\bx(t)$, а ее проекцию $$\bx_l(t) \in \dR^l, \; l < N$$ в траекторное подпространство 

\subsection{Метод PLS}
Метод частичных наименьших квадратов восстанавливает связь между наборами данных $\bX$ и $\bY$. 
Матрицы объектов $\bX$ и целевая матрица $\bY$ проецируются на латентное пространство $\dR^l$ меньшей размерности следующим образом:
$$ \underset{n \times m}{\bX} = \underset{n \times l}{\bT} \cdot \underset{l \times m}{\bP\T} + \underset{n \times m}{\bE} $$
$$ \underset{n \times k}{\bY} = \underset{n \times l}{\bU} \cdot \underset{l \times k}{\bQ\T} + \underset{n \times k}{\bF}, $$
где $\bT$ и $\bU$ --- матрицы описания объектов и исходов в латентном пространстве, $\bP$ и $\bQ$ --- матрицы перехода из латентного пространства в исходное, $\bE$ и $\bF$ --- матрицы остатков.

Функция преобразования исходных данных имеет вид: 
$$ f(\bX) = \bX\bW_{\bx} \qquad g(\bY) = \bY\bW_{\by}, $$ 
где матрицы весов $\bW_{\bx} \in \dR^{m \times l}$ и $\bW_{\by} \in \dR^{k \times l}$ находятся путём максимизации выборочной ковариации:
$$ (\bW_{\bx}, \bW_{\by}) = \underset{\bW_{\bx}, \bW_{\by}}{argmax}\; Cov(\bX\bW_{\bx}, \bY\bW_{\by})$$

\subsection{Метод CCA}
Канонический корреляционный анализ находит две матрицы перехода в латентные пространства для $\bX$ и $\bY$ соответственно, так чтобы коэффициент корреляции между проекциями был максимальным.
\begin{equation} \label{eq:cca_optim}
	(\bw_{\bx_1}, \bw_{\by_1}) = \underset{\bw_{\bx}, \bw_{\by}}{argmax}\; Corr(\bX\bw_{\bx}, \bY\bw_{\by})
\end{equation}
Первые столбцы матриц весов находятся путём решения данной задачи оптимизации \eqref{eq:cca_optim}. 
Затем ищутся векторы, максимизирующие ту же корреляцию, но с ограничением, что они не коррелируют с первой парой векторов.
Процедура продолжается $l$ шагов, где $l$ --- размерность латентного пространства.

\subsection{Алгоритм предсказания}
TODO

\bibliographystyle{unsrtnat}
\bibliography{Vladimirov2022RestoringHandMovement.bib}

\end{document}